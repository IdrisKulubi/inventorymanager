# Inventory Management System Migration Guide

This guide provides instructions for migrating the database schema and updating existing data to support the new inventory categories and fixed assets features.

## Overview of Changes

The migration adds support for:

1. Four main inventory categories:
   - Chocolate Room
   - Beer Room
   - Kitchen
   - Fixed Assets

2. Subcategories for each main category
3. Fixed assets tracking with location information
4. Optional fields for non-fixed assets (expiry date, shelf life)

## Migration Steps

### 1. Apply Database Migrations

The migration file `drizzle/0002_peaceful_zuras.sql` has been automatically generated by Drizzle. To apply it:

```bash
# Navigate to your project directory
cd inventorymanager

# Run the migration
npx drizzle-kit push:pg
```

### 2. Update Existing Data

After applying the migration, you need to update existing data to match the new schema. We've created a script to help with this:

```bash
# Run the data update script
npx tsx src/scripts/update-inventory-data.ts
```

This script will:
- Set appropriate subcategories for existing items
- Mark items in the 'fixed_assets' category as fixed assets
- Set default asset locations for fixed assets

### 3. Verify the Migration

After completing the migration, verify that everything is working correctly:

```bash
# Start the development server
npm run dev
```

Navigate to the application in your browser and check that:
- All inventory items are displayed correctly
- You can add new items with the new categories and subcategories
- Fixed assets are displayed with their locations
- Consumable items show expiry dates

## Troubleshooting

If you encounter any issues during the migration:

### Database Schema Issues

If you see errors related to missing columns or tables:

1. Check that the migration was applied successfully
2. Verify the database schema matches the expected structure
3. If necessary, run the migration again

### Data Consistency Issues

If data appears incorrect or incomplete:

1. Run the data update script again
2. Check the console output for any errors
3. Manually update any problematic records using the admin interface

### Application Errors

If the application fails to start or displays errors:

1. Check the server logs for specific error messages
2. Verify that all code changes have been applied correctly
3. Restart the development server

## Support

If you need further assistance with the migration, please contact the development team. 